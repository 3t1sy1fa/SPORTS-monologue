---
layout: layout.njk
title: êµ¬ë‹¨ ë¶„ì„
description: "KBO 10ê°œ êµ¬ë‹¨ì˜ ì „ë ¥ ë¶„ì„, ê²½ê¸° ì¼ì •, ìµœì‹  ë‰´ìŠ¤ì™€ ì¸ê¸° êµ¬ë‹¨ ìˆœìœ„ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”."
---

{% block styles %}
<link rel="stylesheet" href="/style/team-base.css" />
{% endblock %}

{% block content %}
<h1 class="page-title">êµ¬ë‹¨ ë¶„ì„</h1>

{% set voteTeams = voteSummary.teams if voteSummary and voteSummary.teams is iterable else [] %}

{% set sortedTeams = [] %}
{% for team in voteTeams %}
  {% set sortedTeams = sortedTeams.concat([team]) %}
{% endfor %}

{% set topTeams = sortedTeams | sort(attribute="teamTotalVotes") | reverse | slice(0, 3) %}

<section class="top-teams-section">
  <h2>ì¸ê¸° êµ¬ë‹¨ TOP 3</h2>
  <div class="top-teams-card-wrapper">
    {% if topTeams | length > 0 %}
      {% for team in topTeams %}
        <div class="top-team-card team-{{ team.teamSlug }}">
          <img src="/images/{{ team.teamSlug }}.png" alt="{{ team.teamName }}">
          <div>
            <h3>{{ team.teamName }}</h3>
            <p>{{ team.teamTotalVotes }}í‘œ</p>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="no-data">ì¸ê¸° êµ¬ë‹¨ ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.</p>
    {% endif %}
  </div>
</section>

{# ğŸ“Š êµ¬ë‹¨ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ #}
{% set teamsArray = teamsBoard if teamsBoard is iterable else [] %}
<section class="teams-card-section">
  {% for team in teamsArray | sort(attribute="rank") %}
    {% set count = 0 %}
    {% for vote in voteTeams %}
      {% if vote.teamSlug == team.slug %}
        {% set count = vote.teamTotalVotes %}
      {% endif %}
    {% endfor %}
    <div class="team-card team-{{ team.slug }}">
      <a href="/teams/{{ team.slug }}/">
        <img src="/images/{{ team.slug }}.png" alt="{{ team.name }}">
        <div class="team-info">
          <h3>{{ team.name }}</h3>
          <p>ìˆœìœ„: {{ team.rank }}ìœ„ | ìŠ¹ë¥ : {{ team.winRate }}</p>
          <span class="last-game">ìµœê·¼ ê²½ê¸°: {{ team.lastGame }}</span>
          <span class="vote-count">íˆ¬í‘œ ìˆ˜: {{ count }}í‘œ</span>
        </div>
      </a>
      <button class="vote-btn" data-type="team" data-slug="{{ team.slug }}">
        ì´ êµ¬ë‹¨ì— íˆ¬í‘œí•˜ê¸°
      </button>
    </div>
  {% endfor %}
</section>

{% set scheduleArray = leagueSchedule if leagueSchedule and leagueSchedule is iterable else [] %}
{% set today = "now" | date("yyyy-MM-dd") %}

{% set upcomingGames = [] %}
{% for game in scheduleArray %}
  {% if game.date and game.date >= today %}
    {% set upcomingGames = upcomingGames.concat([game]) %}
  {% endif %}
{% endfor %}
{% set upcomingGames = upcomingGames | sort(attribute="date") | slice(0, 7) %}

<section class="extra-info">
  <div class="weekly-schedule">
    <h3>ì´ë²ˆ ì£¼ ê²½ê¸° ì¼ì •</h3>
    {% if upcomingGames | length > 0 %}
      <ul>
        {% for game in upcomingGames %}
          <li>
            <time datetime="{{ game.date }}">{{ game.date | date("MM.dd") }}</time>
            {{ game.home }} ({{ game.homeScore or "-" }})
            vs
            {{ game.away }} ({{ game.awayScore or "-" }})
            <span class="status">{{ game.status }}</span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="no-data">ì´ë²ˆ ì£¼ ê²½ê¸° ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </div>
</section>

<script type="module">
  import { handleVote } from "/scripts/voteHandler.js";
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".vote-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        handleVote(btn.dataset.type, btn.dataset.slug);
      });
    });
  });
</script>
{% endblock %}