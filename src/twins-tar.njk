---
title: "트윈스타"
layout: layout.njk
description: "무적 LG, 끝까지 Twins! TwinS-TAR 대시보드"
---

{# NOTE: twins-tar.css는 layout.njk에서 title == '트윈스타'일 때 이미 로드됨. 중복 로드 금지 #}

{% set monthISO %}2025-08{% endset %}
{% set twinsArray = twinsSchedule or [] %}
{% if voteSummary and voteSummary.players %}
  {% set allVotes = voteSummary.players %}
{% else %}
  {% set allVotes = [] %}
{% endif %}
{% set playersAll = players | default([]) %}

{# ============================
   LG 로스터 (대소문자 무시 수동 필터)
============================ #}
{% set lgRoster = [] %}
{% for p in playersAll %}
  {% if p.teamSlug and (p.teamSlug | lower) == "lg" %}
    {% set lgRoster = lgRoster + [p] %}
  {% endif %}
{% endfor %}

{# ============================
   인기 TOP3 (정렬/필터 미사용, 한 번의 루프)
============================ #}
{% set t1 = null %}{% set t1v = -1 %}
{% set t2 = null %}{% set t2v = -1 %}
{% set t3 = null %}{% set t3v = -1 %}

{% for v in allVotes %}
  {% if v.playerTeamSlug and (v.playerTeamSlug | lower) == "lg" %}
    {% set votes = (v.playerTotalVotes or 0) + 0 %}
    {% if votes > t1v %}
      {% set t3 = t2 %}{% set t3v = t2v %}
      {% set t2 = t1 %}{% set t2v = t1v %}
      {% set t1 = v  %}{% set t1v = votes %}
    {% elseif votes > t2v %}
      {% set t3 = t2 %}{% set t3v = t2v %}
      {% set t2 = v  %}{% set t2v = votes %}
    {% elseif votes > t3v %}
      {% set t3 = v  %}{% set t3v = votes %}
    {% endif %}
  {% endif %}
{% endfor %}

{# ============================
   최근 경기 3개 (버퍼 방식, reverse/slice 불필요)
   twinsArray가 시간순(과거→현재)이라고 가정
============================ #}
{% set r1 = null %}{% set r2 = null %}{% set r3 = null %}
{% for g in twinsArray %}
  {% if g and (g.status == "종료" or g.state == "done") %}
    {% set r3 = r2 %}{% set r2 = r1 %}{% set r1 = g %}
  {% endif %}
{% endfor %}

{% block content %}
<section class="twins-dashboard">
  <header class="dashboard-header">
    <p class="slogan">무적 LG, 끝까지 Twins!</p>
    <h1 class="main-title">TWINS DASHBOARD</h1>
  </header>

  <div class="dashboard-layout">
    <!-- 사이드바 -->
    <aside class="sidebar">
      <!-- ✅ 달력 -->
      <div class="calendar-card">
        <h3>📅 경기 캘린더</h3>
        <table class="calendar-table" aria-label="월간 경기 캘린더">
          <thead>
            <tr>
              <th scope="col">일</th><th scope="col">월</th><th scope="col">화</th>
              <th scope="col">수</th><th scope="col">목</th><th scope="col">금</th><th scope="col">토</th>
            </tr>
          </thead>
          <tbody>
            {% for week in twinsArray | monthCalendarTwins(monthISO) %}
            <tr>
              {% for day in week %}
                {% if day %}
                  <td class="{{ day.cssClass }}">
                    <div class="cal-day">{{ day.day }}</div>
                    {% if day.logo %}
                      <img
                        src="/images/{{ day.logo }}.png"
                        class="team-logo"
                        alt="상대팀 로고"
                        loading="lazy"
                        decoding="async"
                        onerror="this.style.opacity=0.25"
                      >
                    {% endif %}
                  </td>
                {% else %}
                  <td class="is-empty" aria-hidden="true"></td>
                {% endif %}
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- ✅ 최근 경기 3개 (r1 최신) -->
      <div class="recent-matches">
        <h3>⚾ 최근 경기</h3>
        <ul>
          {% set out = [r1, r2, r3] %}
          {% set any = false %}
          {% for game in out %}
            {% if game %}
              {% set any = true %}
              {# ▼▼▼ 여기(기존 line 115) 삼항 제거 ▼▼▼ #}
              {% set cls = "" %}
              {% if game.result == "승" %}
                {% set cls = "win" %}
              {% elseif game.result == "패" %}
                {% set cls = "lose" %}
              {% endif %}
              <li class="match-item {{ cls }}">
                <span>{{ game.date or "-" }} – {{ game.opponent or game.opponentName or "상대 미정" }}</span>
                <span class="score">{{ game.score or "-" }}</span>
              </li>
            {% endif %}
          {% endfor %}
          {% if not any %}
            <li class="empty">표시할 최근 경기 결과가 없습니다.</li>
          {% endif %}
        </ul>
      </div>

      <a href="https://www.lgtwins.com/" target="_blank" rel="noopener" class="official-btn">
        🔗 공식 홈페이지
      </a>
    </aside>

    <!-- 메인 -->
    <main class="main-panel">
      <section class="top-players">
        <h2>🔥 인기 선수 TOP 3</h2>
        <div class="top-player-cards">
          {% set anyTop = (t1v >= 0) %}
          {% if anyTop %}
            {% if t1 %}
              <div class="player-card">
                <img
                  src="/images/players/{{ t1.playerSlug }}.png"
                  class="player-img"
                  alt="{{ t1.playerName }}"
                  loading="lazy"
                  decoding="async"
                  onerror="this.style.opacity=0.25"
                >
                <h4>{{ t1.playerName }}</h4>
                <p>투표 수: {{ t1.playerTotalVotes or 0 }}</p>
                <button class="vote-btn" data-type="player" data-slug="{{ t1.playerSlug }}">응원하기</button>
              </div>
            {% endif %}
            {% if t2 %}
              <div class="player-card">
                <img
                  src="/images/players/{{ t2.playerSlug }}.png"
                  class="player-img"
                  alt="{{ t2.playerName }}"
                  loading="lazy"
                  decoding="async"
                  onerror="this.style.opacity=0.25"
                >
                <h4>{{ t2.playerName }}</h4>
                <p>투표 수: {{ t2.playerTotalVotes or 0 }}</p>
                <button class="vote-btn" data-type="player" data-slug="{{ t2.playerSlug }}">응원하기</button>
              </div>
            {% endif %}
            {% if t3 %}
              <div class="player-card">
                <img
                  src="/images/players/{{ t3.playerSlug }}.png"
                  class="player-img"
                  alt="{{ t3.playerName }}"
                  loading="lazy"
                  decoding="async"
                  onerror="this.style.opacity=0.25"
                >
                <h4>{{ t3.playerName }}</h4>
                <p>투표 수: {{ t3.playerTotalVotes or 0 }}</p>
                <button class="vote-btn" data-type="player" data-slug="{{ t3.playerSlug }}">응원하기</button>
              </div>
            {% endif %}
          {% else %}
            <p class="empty">아직 투표 데이터가 없습니다.</p>
          {% endif %}
        </div>
      </section>

      <section class="all-players">
        <h2>👥 전체 선수단</h2>
        <div class="players-grid">
          {% if lgRoster and (lgRoster | length) > 0 %}
            {% for p in lgRoster %}
              <div class="player-card full">
                <img
                  src="/images/players/{{ p.slug }}.png"
                  class="player-img"
                  alt="{{ p.name }}"
                  loading="lazy"
                  decoding="async"
                  onerror="this.style.opacity=0.25"
                >
                <div class="info">
                  <h4>
                    {{ p.name }}{% if p.number %} <span>#{{ p.number }}</span>{% endif %}
                  </h4>
                  <p class="pos">{{ p.position or "포지션 미정" }}</p>
                  {% if p.note %}<p class="note">{{ p.note }}</p>{% endif %}
                  <button class="vote-btn" data-type="player" data-slug="{{ p.slug }}">투표하기</button>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="empty">LG 선수단 데이터가 없습니다.</p>
          {% endif %}
        </div>
      </section>
    </main>
  </div>
</section>

<script type="module">
  import { handleVote } from "/scripts/voteHandler.js";
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".vote-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        handleVote(btn.dataset.type, btn.dataset.slug);
      });
    });
  });
</script>
{% endblock %}