<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="naver-site-verification" content="2b5866b9f8fde114c370fca27185fb6a7a1ea7d5" />
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="shortcut icon" href="/favicon.png" type="image/png">
  
  <title>{{ title or "teams" }} | 구단 분석</title>
  <meta name="description" content="{{ description or (title ~ ' 전력 분석 및 경기 리뷰') }}">

  <!-- ✅ 오픈 그래프 -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="{{ title or '구단 분석' }}">
  <meta property="og:description" content="{{ description or (title ~ ' 전력 분석 및 경기 리뷰') }}">
  <meta property="og:image" content="{{ image or 'https://3t1sy1fa.com/images/og-image.jpg' }}">
  <meta property="og:url" content="https://3t1sy1fa.com{{ page.url }}">

  <!-- ✅ 트위터 카드 -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ title or '구단 분석' }}">
  <meta name="twitter:description" content="{{ description or (title ~ ' 전력 분석 및 경기 리뷰') }}">
  <meta name="twitter:image" content="{{ image or 'https://3t1sy1fa.com/images/og-image.jpg' }}">
  <meta name="twitter:domain" content="Sports Monologue">

  <!-- ✅ 스타일 -->
  <link rel="stylesheet" href="/style/main.css" />
  <link rel="stylesheet" href="/style/team-base.css" />

  {% set teamMap = {
    "LG 트윈스": "team-lg.css",
    "두산 베어스": "team-doosan.css",
    "SSG 랜더스": "team-ssg.css",
    "롯데 자이언츠": "team-lotte.css",
    "삼성 라이온즈": "team-samsung.css",
    "한화 이글스": "team-hanwha.css",
    "KIA 타이거즈": "team-kia.css",
    "키움 히어로즈": "team-kiwoom.css",
    "NC 다이노스": "team-nc.css",
    "KT 위즈": "team-kt.css"
  } %}

  {% set resolvedCss = teamCss or teamMap[title] %}
  {% if resolvedCss %}
    <link rel="stylesheet" href="/style/{{ resolvedCss }}" />
  {% endif %}
</head>

<body>
  {% include "header.njk" %}

  {# ✅ 최근 경기 데이터 (leagueSchedule에서 해당 팀만) #}
  {% set recentGame = (leagueSchedule | reverse).find(game => 
    game.homeSlug == category or game.awaySlug == category
  ) or {
    date: "날짜 정보 없음",
    summary: "요약 정보 없음",
    link: teamsBoard.find(t => t.slug == category).homepage
  } %}

  {# ✅ 글 목록 필터링 #}
  {% set filteredPosts = [] %}
  {% for post in collections.teamPosts %}
    {% if post.data.category == category %}
      {% set filteredPosts = filteredPosts.concat([post]) %}
    {% endif %}
  {% endfor %}

  <main class="team-layout">
    <div class="team-left">
      <div class="game-results">
        <p class="game-date">{{ recentGame.date | date }}</p>
        <p class="game-summary">
          {% if recentGame.home %}
            {{ recentGame.home }} vs {{ recentGame.away }} ({{ recentGame.homeScore }} - {{ recentGame.awayScore }})
          {% else %}
            {{ recentGame.summary }}
          {% endif %}
        </p>
        <a href="{{ teamsBoard.find(t => t.slug == category).homepage }}" 
           class="team-btn" target="_blank" rel="noopener noreferrer">
          구단 공식 홈페이지
        </a>
      </div>

      {% if filteredPosts.length > 0 %}
        <div class="team-post-list-wrapper">
          <h3>상세 분석 목록</h3>
          <ul class="team-post-list">
            {% for post in filteredPosts %}
              <li>
                <a href="{{ post.url }}">{{ post.data.title }}</a>
                <span class="date">{{ post.date | date }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% else %}
        <div class="team-post-list-wrapper">
          <p>등록된 구단 분석글이 없습니다.</p>
        </div>
      {% endif %}
    </div>

    <div class="team-right">
      {{ content | safe }}
    </div>
  </main>

  {% include "footer.njk" %}
</body>
</html>