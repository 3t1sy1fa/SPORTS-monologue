<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ title or "구단 분석" }} | 구단 분석</title>

  <!-- ✅ 공통 스타일 -->
  <link rel="stylesheet" href="/style/main.css" />
  <link rel="stylesheet" href="/style/team-base.css" />

  <!-- ✅ 팀별 색상 스타일 -->
  {% if teamCss %}
    <link rel="stylesheet" href="/style/{{ teamCss }}" />
  {% endif %}
</head>

<body>
  {% include "header.njk" %}

  {# ✅ 최근 경기 정보 세팅 #}
  {% if category and gameResults and gameResults[category] %}
    {% set recentGame = gameResults[category] %}
  {% else %}
    {% set recentGame = {
      date: "날짜 정보 없음",
      summary: "요약 정보 없음",
      link: "#"
    } %}
  {% endif %}

  {# ✅ 이 팀의 글만 수동으로 필터링 #}
  {% set filteredPosts = [] %}
  {% for post in collections.teamPosts %}
    {% if post.data.category == category %}
      {% set filteredPosts = filteredPosts.concat([post]) %}
    {% endif %}
  {% endfor %}

  <main class="team-layout">
    <div class="team-left">
      <div class="game-results">
        <p class="game-date">{{ recentGame.date }}</p>
        <p class="game-summary">{{ recentGame.summary }}</p>
        <a href="{{ recentGame.link }}" class="team-btn" target="_blank" rel="noopener noreferrer">
          구단 공식 홈페이지
        </a>
      </div>

      {# ✅ 분석글 목록 출력 #}
      {% if filteredPosts.length > 0 %}
        <div class="team-post-list-wrapper">
          <h3>상세 분석 목록</h3>
          <ul class="team-post-list">
            {% for post in filteredPosts %}
              <li>
                <a href="{{ post.url }}">{{ post.data.title }}</a>
                <span class="date">{{ post.date | date }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% else %}
        <div class="team-post-list-wrapper">
          <p>등록된 구단 분석글이 없습니다.</p>
        </div>
      {% endif %}
    </div>

    <div class="team-right">
      {{ content | safe }}
    </div>
  </main>

  {% include "footer.njk" %}
</body>
</html>